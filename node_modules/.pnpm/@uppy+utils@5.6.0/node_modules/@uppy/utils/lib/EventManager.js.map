{"version":3,"names":["EventManager","constructor","uppy","Object","defineProperty","_uppy","writable","value","_events","_classPrivateFieldLooseBase","on","event","fn","push","remove","splice","off","onFilePause","fileID","cb","targetFileID","isPaused","onFileRemove","file","id","onPause","onRetry","onRetryAll","getFile","onPauseAll","onCancelAll","eventHandler","_this","arguments","onResumeAll"],"sources":["EventManager.ts"],"sourcesContent":["import type {\n  Uppy,\n  UploadPauseCallback,\n  FileRemovedCallback,\n  UploadRetryCallback,\n  GenericEventCallback,\n} from '@uppy/core'\nimport type { UppyFile } from './UppyFile'\n/**\n * Create a wrapper around an event emitter with a `remove` method to remove\n * all events that were added using the wrapped emitter.\n */\nexport default class EventManager {\n  #uppy: Uppy\n\n  #events: Array<Parameters<typeof Uppy.prototype.on>> = []\n\n  constructor(uppy: Uppy) {\n    this.#uppy = uppy\n  }\n\n  on(\n    event: Parameters<typeof Uppy.prototype.on>[0],\n    fn: Parameters<typeof Uppy.prototype.on>[1],\n  ): Uppy {\n    this.#events.push([event, fn])\n    return this.#uppy.on(event, fn)\n  }\n\n  remove(): void {\n    for (const [event, fn] of this.#events.splice(0)) {\n      this.#uppy.off(event, fn)\n    }\n  }\n\n  onFilePause(fileID: UppyFile['id'], cb: (isPaused: boolean) => void): void {\n    this.on(\n      'upload-pause',\n      (\n        targetFileID: Parameters<UploadPauseCallback>[0],\n        isPaused: Parameters<UploadPauseCallback>[1],\n      ) => {\n        if (fileID === targetFileID) {\n          cb(isPaused)\n        }\n      },\n    )\n  }\n\n  onFileRemove(\n    fileID: UppyFile['id'],\n    cb: (isPaused: UppyFile['id']) => void,\n  ): void {\n    this.on('file-removed', (file: Parameters<FileRemovedCallback<any>>[0]) => {\n      if (fileID === file.id) cb(file.id)\n    })\n  }\n\n  onPause(fileID: UppyFile['id'], cb: (isPaused: boolean) => void): void {\n    this.on(\n      'upload-pause',\n      (\n        targetFileID: Parameters<UploadPauseCallback>[0],\n        isPaused: Parameters<UploadPauseCallback>[1],\n      ) => {\n        if (fileID === targetFileID) {\n          // const isPaused = this.#uppy.pauseResume(fileID)\n          cb(isPaused)\n        }\n      },\n    )\n  }\n\n  onRetry(fileID: UppyFile['id'], cb: () => void): void {\n    this.on(\n      'upload-retry',\n      (targetFileID: Parameters<UploadRetryCallback>[0]) => {\n        if (fileID === targetFileID) {\n          cb()\n        }\n      },\n    )\n  }\n\n  onRetryAll(fileID: UppyFile['id'], cb: () => void): void {\n    this.on('retry-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n\n  onPauseAll(fileID: UppyFile['id'], cb: () => void): void {\n    this.on('pause-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n\n  onCancelAll(\n    fileID: UppyFile['id'],\n    eventHandler: GenericEventCallback,\n  ): void {\n    this.on('cancel-all', (...args: Parameters<GenericEventCallback>) => {\n      if (!this.#uppy.getFile(fileID)) return\n      eventHandler(...args)\n    })\n  }\n\n  onResumeAll(fileID: UppyFile['id'], cb: () => void): void {\n    this.on('resume-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n}\n"],"mappings":"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"}