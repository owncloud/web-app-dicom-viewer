import{watch as n,computed as e,reactive as t,getCurrentInstance as r,effectScope as i,onBeforeUnmount as o,onServerPrefetch as c}from"vue";import u,{cancelToken as a}from"caf";function s(){s=function(){return n};var n={},e=Object.prototype,t=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function u(n,e,t){return Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),n[e]}try{u({},"")}catch(n){u=function(n,e,t){return n[e]=t}}function a(n,e,t,r){var i=Object.create((e&&e.prototype instanceof p?e:p).prototype),o=new L(r||[]);return i._invoke=function(n,e,t){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(t.method=i,t.arg=o;;){var c=t.delegate;if(c){var u=b(c,t);if(u){if(u===l)continue;return u}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var a=f(n,e,t);if("normal"===a.type){if(r=t.done?"completed":"suspendedYield",a.arg===l)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(r="completed",t.method="throw",t.arg=a.arg)}}}(n,t,o),i}function f(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=a;var l={};function p(){}function h(){}function d(){}var v={};u(v,i,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(O([])));g&&g!==e&&t.call(g,i)&&(v=g);var _=d.prototype=p.prototype=Object.create(v);function m(n){["next","throw","return"].forEach(function(e){u(n,e,function(n){return this._invoke(e,n)})})}function w(n,e){function r(i,o,c,u){var a=f(n[i],n,o);if("throw"!==a.type){var s=a.arg,l=s.value;return l&&"object"==typeof l&&t.call(l,"__await")?e.resolve(l.__await).then(function(n){r("next",n,c,u)},function(n){r("throw",n,c,u)}):e.resolve(l).then(function(n){s.value=n,c(s)},function(n){return r("throw",n,c,u)})}u(a.arg)}var i;this._invoke=function(n,t){function o(){return new e(function(e,i){r(n,t,e,i)})}return i=i?i.then(o,o):o()}}function b(n,e){var t=n.iterator[e.method];if(void 0===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=void 0,b(n,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=f(t,n.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[n.resultName]=i.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function x(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function L(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(E,this),this.reset(!0)}function O(n){if(n){var e=n[i];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,o=function e(){for(;++r<n.length;)if(t.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=d,u(_,"constructor",d),u(d,"constructor",h),h.displayName=u(d,c,"GeneratorFunction"),n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,d):(n.__proto__=d,u(n,c,"GeneratorFunction")),n.prototype=Object.create(_),n},n.awrap=function(n){return{__await:n}},m(w.prototype),u(w.prototype,o,function(){return this}),n.AsyncIterator=w,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var c=new w(a(e,t,r,i),o);return n.isGeneratorFunction(t)?c:c.next().then(function(n){return n.done?n.value:c.next()})},m(_),u(_,c,"Generator"),u(_,i,function(){return this}),u(_,"toString",function(){return"[object Generator]"}),n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=O,L.prototype={constructor:L,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!n)for(var e in this)"t"===e.charAt(0)&&t.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function r(t,r){return c.type="throw",c.arg=n,e.next=t,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],c=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=t.call(o,"catchLoc"),a=t.call(o,"finallyLoc");if(u&&a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(n,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&t.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===n||"continue"===n)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=n,c.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(c)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),l},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),x(t),l}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var r=t.completion;if("throw"===r.type){var i=r.arg;x(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,t){return this.delegate={iterator:O(n),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),l}},n}function f(){return f=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},f.apply(this,arguments)}function l(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function p(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return l(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e){return new Promise(function(t){var r=n(e,function(n){null!=n&&(t(n),r&&r())},{immediate:!0})})}var d=function(n){return n._runningInstances.length>=n._maxConcurrency},v=function(n){var e=n._activeInstances[0];e&&e.cancel()},y=function(n){n._enqueuedInstances.forEach(function(n){n.isEnqueued=!1,n.isDropped=!0})};function g(n,t){return t?function(n,t,r){return e(function(){return n().filter(function(n){return n[t]})})}(function(){return n()._instances},t):e(function(){return[]})}function _(n){return e(function(){return n().length})}function m(n){return e(function(){var e=n();return e[e.length-1]})}function w(n){return e(function(){return n()[0]})}function b(n){return t(n)}function E(n){var e="General";n._isDropping&&(e="Drop"),n._isEnqueuing&&(e="Enqueue"),n._isRestartable&&(e="Restartable"),n._isKeepingLatest&&(e="KeepLatest");var t=e+" Task";"General"!==e&&(t=t+" with maxConcurrency "+n._maxConcurrency);var r=n._instances.map(function(n){var e;return n.isSuccessful?e="üçè":n.isRunning||n.isEnqueued?e="üçä":(n.isError||n.isCanceled||n.isDropped)&&(e="üî¥"),{status:e+" "+n.status,value:n.value,error:n.error}});console.log("üö¶ "+t),console.table(r)}function x(n){return"test"===process.env.NODE_ENV?Promise.resolve():new Promise(function(e){return setTimeout(e,n)})}function L(n,e){return new n.CancelToken(function(n){e.pr.catch(function(e){"cancel"===e&&n()})})}function O(n){return q(/*#__PURE__*/s().mark(function e(t){var r=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.apply(void 0,[t].concat([].slice.call(r,1))));case 1:case"end":return e.stop()}},e)}))}function j(n,t,r){var i,o,c={id:r.id,isDropped:!1,isEnqueued:!1,hasStarted:!1,isRunning:!1,isFinished:!1,isCanceling:!1,isCanceled:e(function(){return s.isCanceling&&s.isFinished}),isActive:e(function(){return s.isRunning&&!s.isCanceling}),isSuccessful:!1,isNotDropped:e(function(){return!s.isDropped}),isError:e(function(){return!!s.error}),status:e(function(){var n=[[s.isRunning,"running"],[s.isEnqueued,"enqueued"],[s.isCanceled,"canceled"],[s.isCanceling,"canceling"],[s.isDropped,"dropped"],[s.isError,"error"],[s.isSuccessful,"success"]].find(function(n){return n[0]});return n&&n[1]}),error:null,value:null,cancel:function(n){if((void 0===n?{force:!1}:n).force||(s.isCanceling=!0,s.isEnqueued&&(s.isFinished=!0),s.isEnqueued=!1),s.token&&s._canAbort){s.token.abort("cancel");try{s.token.discard()}catch(n){}s.token=void 0,s._canAbort=!1}},canceledOn:function(n){return n.pr.catch(function(n){s.cancel()}),s},_run:function(){!function(n,e,t,r){var i=new a,o=u(e,i);function c(){n.isRunning=!1,n.isFinished=!0}n.token=i,n.hasStarted=!0,n.isRunning=!0,n.isEnqueued=!1,o.call.apply(o,[n,i].concat(t)).then(function(e){n.value=e,n.isSuccessful=!0,c(),n._deferredObject.resolve(e),n._canAbort=!1,r.onFinish(n)}).catch(function(e){"cancel"!==e&&(n.error=e),c(),n._shouldThrow&&n._deferredObject.reject(e),r.onFinish(n)})}(s,n,t,r)},_handled:!0,_deferredObject:(i={},o=new Promise(function(n,e){i.resolve=n,i.reject=e}),i.promise=o,i),_shouldThrow:!1,_canAbort:!0,then:function(n,e){return s._shouldThrow=!0,s._deferredObject.promise.then(n,e)},catch:function(n,e){return void 0===e&&(e=!0),s._shouldThrow=e,s._deferredObject.promise.catch(n)},finally:function(n){return s._shouldThrow=!0,s._deferredObject.promise.finally(n)}},s=b(c),f=r.modifiers;return f.drop?s.isDropped=!0:f.enqueue?s.isEnqueued=!0:s._run(),s}function q(n,t){void 0===t&&(t={cancelOnUnmount:!0});var c=r(),u=i(),a={_isRestartable:!1,_isDropping:!1,_isEnqueuing:!1,_isKeepingLatest:!1,_maxConcurrency:1,_hasConcurrency:e(function(){return s._isRestartable||s._isDropping||s._isEnqueuing||s._isKeepingLatest}),isIdle:e(function(){return!s.isRunning}),isRunning:e(function(){return!!s._instances.find(function(n){return n.isRunning})}),isError:e(function(){return!(!s.last||!s.last.isError)}),_instances:[],_successfulInstances:g(function(){return s},"isSuccessful"),_runningInstances:g(function(){return s},"isRunning"),_enqueuedInstances:g(function(){return s},"isEnqueued"),_notDroppedInstances:g(function(){return s},"isNotDropped"),_activeInstances:g(function(){return s},"isActive"),performCount:_(function(){return s._instances}),last:m(function(){return s._notDroppedInstances}),lastSuccessful:m(function(){return s._successfulInstances}),firstEnqueued:w(function(){return s._enqueuedInstances}),cancelAll:function(n){var e=(void 0===n?{force:!1}:n).force;s._instances.forEach(function(n){try{(e||!n.isDropped&&!n.isFinished)&&n.cancel({force:e})}catch(n){if("cancel"!==n)throw n}})},perform:function(){var e=arguments,t={enqueue:!1,drop:!1};s._hasConcurrency&&d(s)&&(s._isDropping&&(t.drop=!0),s._isRestartable&&v(s),s._isKeepingLatest&&y(s),(s._isEnqueuing||s._isKeepingLatest)&&(t.enqueue=!0));var r=function(){return k(s)},i=function(){return j(n,[].slice.call(e),{modifiers:t,onFinish:r,scope:u,id:s._instances.length+1})},o=u.active?u.run(i):i();return u.active||console.warn("Task instance has been created in inactive scope. Perhaps youre creating task out of setup?"),s._instances=[].concat(s._instances,[o]),o},clear:function(){this.cancelAll({force:!0}),this._instances=[]},destroy:function(){u.stop(),this.clear()},restartable:function(){return s._resetModifierFlags(),s._isRestartable=!0,s},drop:function(){return s._resetModifierFlags(),s._isDropping=!0,s},enqueue:function(){return s._resetModifierFlags(),s._isEnqueuing=!0,s},keepLatest:function(){return s._resetModifierFlags(),s._isKeepingLatest=!0,s},_resetModifierFlags:function(){s._isKeepingLatest=!1,s._isRestartable=!1,s._isEnqueuing=!1,s._isDropping=!1},maxConcurrency:function(n){return s._maxConcurrency=n,s}},s=b(a);return c&&t.cancelOnUnmount&&o(function(){s._instances&&s.destroy()}),s}function k(n){if(n._isEnqueuing||n._isKeepingLatest){var e=n.firstEnqueued;e&&e._run()}}function C(n){var e=[].slice.call(arguments,1);return q(/*#__PURE__*/s().mark(function t(r){var i,o,c,u,a=arguments;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.perform.apply(n,[].slice.call(a,1)).canceledOn(r);case 2:i=t.sent,o=p(e);case 4:if((c=o()).done){t.next=11;break}return u=c.value,t.next=8,u.perform(i).canceledOn(r);case 8:i=t.sent;case 9:t.next=4;break;case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}},t)}))}function S(){var n=[].slice.call(arguments);return q(/*#__PURE__*/s().mark(function e(t){var r,i=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.map(function(n){return n.perform.apply(n,[].slice.call(i,1)).canceledOn(t)}),e.next=3,Promise.all(r);case 3:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))}function R(){var n=[].slice.call(arguments);return q(/*#__PURE__*/s().mark(function e(t){var r,i,o,c,u=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=p(n);case 2:if((o=i()).done){e.next=11;break}return c=o.value,e.t0=r,e.next=7,c.perform.apply(c,[].slice.call(u,1)).canceledOn(t);case 7:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 9:e.next=2;break;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e)}))}var D=function(){return"undefined"==typeof window};function I(n){n._deferredObject.promise=n.isError?Promise.reject(n.error):Promise.resolve(n.value),n.cancel=function(){},n.canceledOn=function(){return n},n._run=function(){},n.then=function(){var e;return(e=n._deferredObject.promise).then.apply(e,[].slice.call(arguments))},n.catch=function(){var e;return(e=n._deferredObject.promise).catch.apply(e,[].slice.call(arguments))},n.finally=function(){var e;return(e=n._deferredObject.promise).finally.apply(e,[].slice.call(arguments))}}function F(n,e){if(D()){var t=e.perform();return c(function(){try{var r=function(r,i){try{var o=Promise.resolve(t).then(function(){P(n,e)})}catch(n){return}return o&&o.then?o.then(void 0,function(){}):o}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(n){return Promise.reject(n)}}),t}return T(n,e).reverse()[0]||e.perform()}function P(n,t){var i=r().$root,o=i&&i.context&&i.context.nuxtState;if(!o)throw new Error("Could not access $root.context.nuxtState");o.vueConcurrency||(o.vueConcurrency={}),o.vueConcurrency[n]=e(function(){return{instances:t._instances}})}function T(n,e){var t=function(n){if(!A())throw Error("Could not access  window.__NUXT__");return A().vueConcurrency[n].value}(n);return t&&(e._instances=t.instances||[],e._instances.forEach(I),function(n){delete A().vueConcurrency[n]}(n)),e._instances}function A(){return window.__NUXT__}function N(n,e){D()?P(n,e):T(n,e)}function G(n){var r=Object.values(n),i=t(f({isRunning:e(function(){return!!r.find(function(n){return n.isRunning})}),isIdle:e(function(){return!i.isRunning}),isError:e(function(){return!!r.find(function(n){return n.isError})})},n));return i}export{L as getCancelToken,E as printTask,x as timeout,O as useAsyncTask,S as useParallelTask,C as usePipeTask,N as useSSRPersistance,R as useSequentialTask,q as useTask,G as useTaskGroup,F as useTaskPrefetch,h as waitForValue};
//# sourceMappingURL=index.module.js.map
