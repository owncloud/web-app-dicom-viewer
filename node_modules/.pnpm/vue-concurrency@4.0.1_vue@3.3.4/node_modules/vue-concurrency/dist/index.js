var e=require("vue"),n=require("caf");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/t(n);function o(){o=function(){return e};var e={},n=Object.prototype,t=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",u=r.toStringTag||"@@toStringTag";function a(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{a({},"")}catch(e){a=function(e,n,t){return e[n]=t}}function s(e,n,t,r){var o=Object.create((n&&n.prototype instanceof p?n:p).prototype),i=new L(r||[]);return o._invoke=function(e,n,t){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(t.method=o,t.arg=i;;){var c=t.delegate;if(c){var u=b(c,t);if(u){if(u===l)continue;return u}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var a=f(e,n,t);if("normal"===a.type){if(r=t.done?"completed":"suspendedYield",a.arg===l)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(r="completed",t.method="throw",t.arg=a.arg)}}}(e,t,i),o}function f(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function p(){}function d(){}function h(){}var v={};a(v,i,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(O([])));g&&g!==n&&t.call(g,i)&&(v=g);var m=h.prototype=p.prototype=Object.create(v);function _(e){["next","throw","return"].forEach(function(n){a(e,n,function(e){return this._invoke(n,e)})})}function w(e,n){function r(o,i,c,u){var a=f(e[o],e,i);if("throw"!==a.type){var s=a.arg,l=s.value;return l&&"object"==typeof l&&t.call(l,"__await")?n.resolve(l.__await).then(function(e){r("next",e,c,u)},function(e){r("throw",e,c,u)}):n.resolve(l).then(function(e){s.value=e,c(s)},function(e){return r("throw",e,c,u)})}u(a.arg)}var o;this._invoke=function(e,t){function i(){return new n(function(n,o){r(e,t,n,o)})}return o=o?o.then(i,i):i()}}function b(e,n){var t=e.iterator[n.method];if(void 0===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,b(e,n),"throw"===n.method))return l;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=f(t,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,l;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,l):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,l)}function x(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function E(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function O(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(t.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=void 0,n.done=!0,n};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return d.prototype=h,a(m,"constructor",h),a(h,"constructor",d),d.displayName=a(h,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===d||"GeneratorFunction"===(n.displayName||n.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a(e,u,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},_(w.prototype),a(w.prototype,c,function(){return this}),e.AsyncIterator=w,e.async=function(n,t,r,o,i){void 0===i&&(i=Promise);var c=new w(s(n,t,r,o),i);return e.isGeneratorFunction(t)?c:c.next().then(function(e){return e.done?e.value:c.next()})},_(m),a(m,u,"Generator"),a(m,i,function(){return this}),a(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var n=[];for(var t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&t.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t,r){return c.type="throw",c.arg=e,n.next=t,r&&(n.method="next",n.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=t.call(i,"catchLoc"),a=t.call(i,"finallyLoc");if(u&&a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,n){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&t.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=n,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(c)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),l},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),E(t),l}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var r=t.completion;if("throw"===r.type){var o=r.arg;E(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,t){return this.delegate={iterator:O(e),resultName:n,nextLoc:t},"next"===this.method&&(this.arg=void 0),l}},e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i.apply(this,arguments)}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function u(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=function(e){return e._runningInstances.length>=e._maxConcurrency},s=function(e){var n=e._activeInstances[0];n&&n.cancel()},f=function(e){e._enqueuedInstances.forEach(function(e){e.isEnqueued=!1,e.isDropped=!0})};function l(n,t){return t?function(n,t,r){return e.computed(function(){return n().filter(function(e){return e[t]})})}(function(){return n()._instances},t):e.computed(function(){return[]})}function p(n){return e.computed(function(){return n().length})}function d(n){return e.computed(function(){var e=n();return e[e.length-1]})}function h(n){return e.computed(function(){return n()[0]})}function v(n){return e.reactive(n)}function y(t,o,i){var c,u,a={id:i.id,isDropped:!1,isEnqueued:!1,hasStarted:!1,isRunning:!1,isFinished:!1,isCanceling:!1,isCanceled:e.computed(function(){return s.isCanceling&&s.isFinished}),isActive:e.computed(function(){return s.isRunning&&!s.isCanceling}),isSuccessful:!1,isNotDropped:e.computed(function(){return!s.isDropped}),isError:e.computed(function(){return!!s.error}),status:e.computed(function(){var e=[[s.isRunning,"running"],[s.isEnqueued,"enqueued"],[s.isCanceled,"canceled"],[s.isCanceling,"canceling"],[s.isDropped,"dropped"],[s.isError,"error"],[s.isSuccessful,"success"]].find(function(e){return e[0]});return e&&e[1]}),error:null,value:null,cancel:function(e){if((void 0===e?{force:!1}:e).force||(s.isCanceling=!0,s.isEnqueued&&(s.isFinished=!0),s.isEnqueued=!1),s.token&&s._canAbort){s.token.abort("cancel");try{s.token.discard()}catch(e){}s.token=void 0,s._canAbort=!1}},canceledOn:function(e){return e.pr.catch(function(e){s.cancel()}),s},_run:function(){!function(e,t,o,i){var c=new n.cancelToken,u=r.default(t,c);function a(){e.isRunning=!1,e.isFinished=!0}e.token=c,e.hasStarted=!0,e.isRunning=!0,e.isEnqueued=!1,u.call.apply(u,[e,c].concat(o)).then(function(n){e.value=n,e.isSuccessful=!0,a(),e._deferredObject.resolve(n),e._canAbort=!1,i.onFinish(e)}).catch(function(n){"cancel"!==n&&(e.error=n),a(),e._shouldThrow&&e._deferredObject.reject(n),i.onFinish(e)})}(s,t,o,i)},_handled:!0,_deferredObject:(c={},u=new Promise(function(e,n){c.resolve=e,c.reject=n}),c.promise=u,c),_shouldThrow:!1,_canAbort:!0,then:function(e,n){return s._shouldThrow=!0,s._deferredObject.promise.then(e,n)},catch:function(e,n){return void 0===n&&(n=!0),s._shouldThrow=n,s._deferredObject.promise.catch(e)},finally:function(e){return s._shouldThrow=!0,s._deferredObject.promise.finally(e)}},s=v(a),f=i.modifiers;return f.drop?s.isDropped=!0:f.enqueue?s.isEnqueued=!0:s._run(),s}function g(n,t){void 0===t&&(t={cancelOnUnmount:!0});var r=e.getCurrentInstance(),o=e.effectScope(),i={_isRestartable:!1,_isDropping:!1,_isEnqueuing:!1,_isKeepingLatest:!1,_maxConcurrency:1,_hasConcurrency:e.computed(function(){return c._isRestartable||c._isDropping||c._isEnqueuing||c._isKeepingLatest}),isIdle:e.computed(function(){return!c.isRunning}),isRunning:e.computed(function(){return!!c._instances.find(function(e){return e.isRunning})}),isError:e.computed(function(){return!(!c.last||!c.last.isError)}),_instances:[],_successfulInstances:l(function(){return c},"isSuccessful"),_runningInstances:l(function(){return c},"isRunning"),_enqueuedInstances:l(function(){return c},"isEnqueued"),_notDroppedInstances:l(function(){return c},"isNotDropped"),_activeInstances:l(function(){return c},"isActive"),performCount:p(function(){return c._instances}),last:d(function(){return c._notDroppedInstances}),lastSuccessful:d(function(){return c._successfulInstances}),firstEnqueued:h(function(){return c._enqueuedInstances}),cancelAll:function(e){var n=(void 0===e?{force:!1}:e).force;c._instances.forEach(function(e){try{(n||!e.isDropped&&!e.isFinished)&&e.cancel({force:n})}catch(e){if("cancel"!==e)throw e}})},perform:function(){var e=arguments,t={enqueue:!1,drop:!1};c._hasConcurrency&&a(c)&&(c._isDropping&&(t.drop=!0),c._isRestartable&&s(c),c._isKeepingLatest&&f(c),(c._isEnqueuing||c._isKeepingLatest)&&(t.enqueue=!0));var r=function(){return m(c)},i=function(){return y(n,[].slice.call(e),{modifiers:t,onFinish:r,scope:o,id:c._instances.length+1})},u=o.active?o.run(i):i();return o.active||console.warn("Task instance has been created in inactive scope. Perhaps youre creating task out of setup?"),c._instances=[].concat(c._instances,[u]),u},clear:function(){this.cancelAll({force:!0}),this._instances=[]},destroy:function(){o.stop(),this.clear()},restartable:function(){return c._resetModifierFlags(),c._isRestartable=!0,c},drop:function(){return c._resetModifierFlags(),c._isDropping=!0,c},enqueue:function(){return c._resetModifierFlags(),c._isEnqueuing=!0,c},keepLatest:function(){return c._resetModifierFlags(),c._isKeepingLatest=!0,c},_resetModifierFlags:function(){c._isKeepingLatest=!1,c._isRestartable=!1,c._isEnqueuing=!1,c._isDropping=!1},maxConcurrency:function(e){return c._maxConcurrency=e,c}},c=v(i);return r&&t.cancelOnUnmount&&e.onBeforeUnmount(function(){c._instances&&c.destroy()}),c}function m(e){if(e._isEnqueuing||e._isKeepingLatest){var n=e.firstEnqueued;n&&n._run()}}var _=function(){return"undefined"==typeof window};function w(e){e._deferredObject.promise=e.isError?Promise.reject(e.error):Promise.resolve(e.value),e.cancel=function(){},e.canceledOn=function(){return e},e._run=function(){},e.then=function(){var n;return(n=e._deferredObject.promise).then.apply(n,[].slice.call(arguments))},e.catch=function(){var n;return(n=e._deferredObject.promise).catch.apply(n,[].slice.call(arguments))},e.finally=function(){var n;return(n=e._deferredObject.promise).finally.apply(n,[].slice.call(arguments))}}function b(n,t){var r=e.getCurrentInstance().$root,o=r&&r.context&&r.context.nuxtState;if(!o)throw new Error("Could not access $root.context.nuxtState");o.vueConcurrency||(o.vueConcurrency={}),o.vueConcurrency[n]=e.computed(function(){return{instances:t._instances}})}function x(e,n){var t=function(e){if(!E())throw Error("Could not access  window.__NUXT__");return E().vueConcurrency[e].value}(e);return t&&(n._instances=t.instances||[],n._instances.forEach(w),function(e){delete E().vueConcurrency[e]}(e)),n._instances}function E(){return window.__NUXT__}exports.getCancelToken=function(e,n){return new e.CancelToken(function(e){n.pr.catch(function(n){"cancel"===n&&e()})})},exports.printTask=function(e){var n="General";e._isDropping&&(n="Drop"),e._isEnqueuing&&(n="Enqueue"),e._isRestartable&&(n="Restartable"),e._isKeepingLatest&&(n="KeepLatest");var t=n+" Task";"General"!==n&&(t=t+" with maxConcurrency "+e._maxConcurrency);var r=e._instances.map(function(e){var n;return e.isSuccessful?n="🍏":e.isRunning||e.isEnqueued?n="🍊":(e.isError||e.isCanceled||e.isDropped)&&(n="🔴"),{status:n+" "+e.status,value:e.value,error:e.error}});console.log("🚦 "+t),console.table(r)},exports.timeout=function(e){return"test"===process.env.NODE_ENV?Promise.resolve():new Promise(function(n){return setTimeout(n,e)})},exports.useAsyncTask=function(e){return g(/*#__PURE__*/o().mark(function n(t){var r=arguments;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.apply(void 0,[t].concat([].slice.call(r,1))));case 1:case"end":return n.stop()}},n)}))},exports.useParallelTask=function(){var e=[].slice.call(arguments);return g(/*#__PURE__*/o().mark(function n(t){var r,i=arguments;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.map(function(e){return e.perform.apply(e,[].slice.call(i,1)).canceledOn(t)}),n.next=3,Promise.all(r);case 3:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}},n)}))},exports.usePipeTask=function(e){var n=[].slice.call(arguments,1);return g(/*#__PURE__*/o().mark(function t(r){var i,c,a,s,f=arguments;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.perform.apply(e,[].slice.call(f,1)).canceledOn(r);case 2:i=t.sent,c=u(n);case 4:if((a=c()).done){t.next=11;break}return s=a.value,t.next=8,s.perform(i).canceledOn(r);case 8:i=t.sent;case 9:t.next=4;break;case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}},t)}))},exports.useSSRPersistance=function(e,n){_()?b(e,n):x(e,n)},exports.useSequentialTask=function(){var e=[].slice.call(arguments);return g(/*#__PURE__*/o().mark(function n(t){var r,i,c,a,s=arguments;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=[],i=u(e);case 2:if((c=i()).done){n.next=11;break}return a=c.value,n.t0=r,n.next=7,a.perform.apply(a,[].slice.call(s,1)).canceledOn(t);case 7:n.t1=n.sent,n.t0.push.call(n.t0,n.t1);case 9:n.next=2;break;case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n)}))},exports.useTask=g,exports.useTaskGroup=function(n){var t=Object.values(n),r=e.reactive(i({isRunning:e.computed(function(){return!!t.find(function(e){return e.isRunning})}),isIdle:e.computed(function(){return!r.isRunning}),isError:e.computed(function(){return!!t.find(function(e){return e.isError})})},n));return r},exports.useTaskPrefetch=function(n,t){if(_()){var r=t.perform();return e.onServerPrefetch(function(){try{var e=function(e,o){try{var i=Promise.resolve(r).then(function(){b(n,t)})}catch(e){return}return i&&i.then?i.then(void 0,function(){}):i}();return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}),r}return x(n,t).reverse()[0]||t.perform()},exports.waitForValue=function(n){return new Promise(function(t){var r=e.watch(n,function(e){null!=e&&(t(e),r&&r())},{immediate:!0})})};
//# sourceMappingURL=index.js.map
